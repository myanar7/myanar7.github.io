// Firebase Configuration - Replace with your actual config
const firebaseConfig = {
    apiKey: "AIzaSyARyz3oNgzvIEIp33nmG9JvzTvy8uVhaH8",
    authDomain: "jungle-log.firebaseapp.com",
    databaseURL: "https://jungle-log-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "jungle-log",
    storageBucket: "jungle-log.firebasestorage.app",
    messagingSenderId: "358753101681",
    appId: "1:358753101681:web:e6d7e5aec2caa123b578d0",
    measurementId: "G-009VFHVTSC"
};

// Firebase imports
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
import { getFirestore, collection, addDoc, serverTimestamp, onSnapshot, deleteDoc, doc, orderBy, query, updateDoc, setDoc, getDoc, getDocs, writeBatch } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-firestore.js";
import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-analytics.js";

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const analytics = getAnalytics(app);

// DOM Elements
const addRouteForm = document.getElementById('add-route-form');
const submitBtn = document.getElementById('submit-btn');
const successMessage = document.getElementById('success-message');
const errorMessage = document.getElementById('error-message');
const routesList = document.getElementById('routes-list');
const confirmationOverlay = document.getElementById('confirmation-overlay');
const confirmDeleteBtn = document.getElementById('confirm-delete');
const cancelDeleteBtn = document.getElementById('cancel-delete');
const confirmationMessage = document.getElementById('confirmation-message');

// Global variables
let routes = [];
let routeToDelete = null;
let currentWeek = '';
let currentMonth = '';
let originalWeek = '';
let originalMonth = '';

// Initialize the routesetter page
document.addEventListener('DOMContentLoaded', function() {
    console.log('üèîÔ∏è Routesetter sayfasƒ± y√ºklendi');
    updatePeriodInfo();
    setupFormHandlers();
    setupRealtimeListeners();
    setupDeleteHandlers();
    setupPeriodHandlers();
});

// Hafta ve ay bilgilerini g√ºncelle
async function updatePeriodInfo() {
    try {
        // Firestore'dan period bilgilerini al
        const periodRef = doc(db, 'system', 'period');
        const periodDoc = await getDoc(periodRef);
        
        if (periodDoc.exists()) {
            const periodData = periodDoc.data();
            currentWeek = periodData.week || getDefaultWeek();
            currentMonth = periodData.month || getDefaultMonth();
            console.log('üìÖ Firestore\'dan period bilgileri alƒ±ndƒ±:', { currentWeek, currentMonth });
        } else {
            // Varsayƒ±lan deƒüerleri kullan
            currentWeek = getDefaultWeek();
            currentMonth = getDefaultMonth();
            console.log('üìÖ Varsayƒ±lan period bilgileri kullanƒ±ldƒ±:', { currentWeek, currentMonth });
        }
        
        // UI'yi g√ºncelle
        const weekInput = document.getElementById('current-week-input');
        const monthInput = document.getElementById('current-month-input');
        
        if (weekInput) {
            weekInput.value = currentWeek;
        }
        
        if (monthInput) {
            monthInput.value = currentMonth;
        }
        
        console.log('üìÖ Hafta ve ay bilgileri g√ºncellendi:', { currentWeek, currentMonth });
    } catch (error) {
        console.error('‚ùå Period bilgileri alƒ±nƒ±rken hata:', error);
        // Hata durumunda varsayƒ±lan deƒüerleri kullan
        currentWeek = getDefaultWeek();
        currentMonth = getDefaultMonth();
        
        const weekInput = document.getElementById('current-week-input');
        const monthInput = document.getElementById('current-month-input');
        
        if (weekInput) weekInput.value = currentWeek;
        if (monthInput) monthInput.value = currentMonth;
    }
}

// Varsayƒ±lan hafta bilgisini al
function getDefaultWeek() {
    const now = new Date();
    const weekStart = new Date(now);
    weekStart.setDate(now.getDate() - now.getDay() + 1); // Pazartesi
    const weekEnd = new Date(weekStart);
    weekEnd.setDate(weekStart.getDate() + 6); // Pazar
    
    return `${weekStart.getDate()}/${weekStart.getMonth() + 1} - ${weekEnd.getDate()}/${weekEnd.getMonth() + 1}`;
}

// Varsayƒ±lan ay bilgisini al
function getDefaultMonth() {
    const now = new Date();
    const monthNames = [
        'Ocak', '≈ûubat', 'Mart', 'Nisan', 'Mayƒ±s', 'Haziran',
        'Temmuz', 'Aƒüustos', 'Eyl√ºl', 'Ekim', 'Kasƒ±m', 'Aralƒ±k'
    ];
    return `${monthNames[now.getMonth()]} ${now.getFullYear()}`;
}

// Google Drive payla≈üƒ±m URL'lerini g√∂r√ºnt√ºlenebilir direkt linke √ßevir
function normalizeImageUrl(url) {
    if (!url) return null;
    try {
        const trimmed = String(url).trim();
        const patterns = [
            /https?:\/\/drive\.google\.com\/file\/d\/([a-zA-Z0-9_-]+)/,
            /https?:\/\/drive\.google\.com\/open\?id=([a-zA-Z0-9_-]+)/,
            /https?:\/\/drive\.google\.com\/uc\?id=([a-zA-Z0-9_-]+)/,
            /https?:\/\/drive\.google\.com\/uc\?export=download&id=([a-zA-Z0-9_-]+)/
        ];
        for (const regex of patterns) {
            const match = trimmed.match(regex);
            if (match && match[1]) {
                return `https://lh3.googleusercontent.com/d/${match[1]}`;
            }
        }
        return trimmed;
    } catch (e) {
        return url;
    }
}

// Hafta ve ay d√ºzenleme event handler'larƒ±
function setupPeriodHandlers() {
    // Hafta d√ºzenleme
    const editWeekBtn = document.getElementById('edit-week-btn');
    const saveWeekBtn = document.getElementById('save-week-btn');
    const cancelWeekBtn = document.getElementById('cancel-week-btn');
    const weekInput = document.getElementById('current-week-input');
    
    // Ay d√ºzenleme
    const editMonthBtn = document.getElementById('edit-month-btn');
    const saveMonthBtn = document.getElementById('save-month-btn');
    const cancelMonthBtn = document.getElementById('cancel-month-btn');
    const monthInput = document.getElementById('current-month-input');
    
    // Hafta d√ºzenleme
    editWeekBtn.addEventListener('click', () => {
        originalWeek = weekInput.value;
        weekInput.readOnly = false;
        weekInput.focus();
        editWeekBtn.style.display = 'none';
        saveWeekBtn.style.display = 'inline-block';
        cancelWeekBtn.style.display = 'inline-block';
    });
    
    saveWeekBtn.addEventListener('click', async () => {
        const newWeek = weekInput.value.trim();
        if (newWeek && newWeek !== originalWeek) {
            await updatePeriodInDatabase('week', newWeek);
            currentWeek = newWeek;
            weekInput.readOnly = true;
            editWeekBtn.style.display = 'inline-block';
            saveWeekBtn.style.display = 'none';
            cancelWeekBtn.style.display = 'none';
        }
    });
    
    cancelWeekBtn.addEventListener('click', () => {
        weekInput.value = originalWeek;
        weekInput.readOnly = true;
        editWeekBtn.style.display = 'inline-block';
        saveWeekBtn.style.display = 'none';
        cancelWeekBtn.style.display = 'none';
    });
    
    // Ay d√ºzenleme
    editMonthBtn.addEventListener('click', () => {
        originalMonth = monthInput.value;
        monthInput.readOnly = false;
        monthInput.focus();
        editMonthBtn.style.display = 'none';
        saveMonthBtn.style.display = 'inline-block';
        cancelMonthBtn.style.display = 'inline-block';
    });
    
    saveMonthBtn.addEventListener('click', async () => {
        const newMonth = monthInput.value.trim();
        if (newMonth && newMonth !== originalMonth) {
            await updatePeriodInDatabase('month', newMonth);
            currentMonth = newMonth;
            monthInput.readOnly = true;
            editMonthBtn.style.display = 'inline-block';
            saveMonthBtn.style.display = 'none';
            cancelMonthBtn.style.display = 'none';
        }
    });
    
    cancelMonthBtn.addEventListener('click', () => {
        monthInput.value = originalMonth;
        monthInput.readOnly = true;
        editMonthBtn.style.display = 'inline-block';
        saveMonthBtn.style.display = 'none';
        cancelMonthBtn.style.display = 'none';
    });
    
    // Aylƒ±k puanlarƒ± sƒ±fƒ±rlama butonu
    const resetMonthlyScoresBtn = document.getElementById('reset-monthly-scores-btn');
    if (resetMonthlyScoresBtn) {
        resetMonthlyScoresBtn.addEventListener('click', async () => {
            if (confirm('‚ö†Ô∏è T√ºm kullanƒ±cƒ±larƒ±n aylƒ±k puanlarƒ± sƒ±fƒ±rlanacak ve ge√ßmi≈üe kaydedilecek. Emin misiniz?')) {
                await resetMonthlyScores();
            }
        });
    }
}

// Aylƒ±k puanlarƒ± sƒ±fƒ±rla
async function resetMonthlyScores() {
    try {
        console.log('üîÑ Aylƒ±k puanlar sƒ±fƒ±rlanƒ±yor...');
        
        // Loading g√∂ster
        const resetBtn = document.getElementById('reset-monthly-scores-btn');
        const originalText = resetBtn.textContent;
        resetBtn.textContent = '‚è≥ Sƒ±fƒ±rlanƒ±yor...';
        resetBtn.disabled = true;
        
        // T√ºm userStats'larƒ± al
        const userStatsRef = collection(db, 'userStats');
        const userStatsSnapshot = await getDocs(userStatsRef);
        
        if (userStatsSnapshot.empty) {
            alert('‚ö†Ô∏è Hi√ß kullanƒ±cƒ± istatistiƒüi bulunamadƒ±');
            resetBtn.textContent = originalText;
            resetBtn.disabled = false;
            return;
        }
        
        // T√ºm users collection'ƒ±nƒ± √ßek (sadece name field'ƒ± i√ßin)
        console.log('üë• Kullanƒ±cƒ± isimleri y√ºkleniyor...');
        const usersRef = collection(db, 'users');
        const usersSnapshot = await getDocs(usersRef);
        
        // User ID -> Name mapping olu≈ütur
        const userIdToNameAndGenderMap = {};
        usersSnapshot.docs.forEach(userDoc => {
            const userData = userDoc.data();
            userIdToNameAndGenderMap[userDoc.id] = {'name': userData.name || 'Bilinmeyen', 'gender': userData.gender || 'erkek' || 'kadƒ±n'};
        });
        
        console.log('üìä User mapping olu≈üturuldu:', Object.keys(userIdToNameAndGenderMap).length, 'kullanƒ±cƒ±');
        console.log('üìä User mapping:', userIdToNameAndGenderMap);
        
        const batch = writeBatch(db);
        const periodRef = doc(db, 'system', 'period');
        const periodDoc = await getDoc(periodRef);
        const currentMonth = periodDoc.exists() ? periodDoc.data().month : new Date().toLocaleDateString('tr-TR', { month: 'long', year: 'numeric' });
        
        // Ge√ßmi≈ü ay verilerini sakla
        const monthlyHistoryData = {
            month: currentMonth,
            userStats: {},
            resetAt: serverTimestamp(),
            createdAt: serverTimestamp()
        };
        
        // Her kullanƒ±cƒ± i√ßin i≈ülem yap
        userStatsSnapshot.docs.forEach(userStatsDoc => {
            const userStatsData = userStatsDoc.data();
            const userId = userStatsDoc.id;
            
            // G√ºvenli eri≈üim i√ßin kontrol
            const userInfo = userIdToNameAndGenderMap[userId];
            const userName = userInfo ? userInfo.name : 'Bilinmeyen';
            const userGender = userInfo ? userInfo.gender : 'erkek';
            
            console.log('Denemeler: ', userName, userGender);
            // Ge√ßmi≈ü verileri sakla (name mapping'den al)
            monthlyHistoryData.userStats[userId] = {
                monthlyScore: userStatsData.monthlyScore || 0,
                name: userName,
                gender: userGender
            };
            
            // Monthly score'u sƒ±fƒ±rla
            batch.update(userStatsDoc.ref, {
                monthlyScore: 0,
                currentWeekCompleted: 0,
                lastUpdated: serverTimestamp()
            });
        });
        
        // Ge√ßmi≈ü verileri monthlyHistory collection'ƒ±na kaydet
        const historyRef = doc(collection(db, 'monthlyHistory'));
        batch.set(historyRef, monthlyHistoryData);
        
        await batch.commit();
        
        console.log('‚úÖ Aylƒ±k puanlar sƒ±fƒ±rlandƒ± ve ge√ßmi≈üe kaydedildi');
        console.log('üìä Sƒ±fƒ±rlanan kullanƒ±cƒ± sayƒ±sƒ±:', userStatsSnapshot.docs.length);
        console.log('üìÖ Ay:', currentMonth);
        
        alert(`‚úÖ Aylƒ±k puanlar ba≈üarƒ±yla sƒ±fƒ±rlandƒ±!\nüìä Sƒ±fƒ±rlanan kullanƒ±cƒ±: ${userStatsSnapshot.docs.length}\nüìÖ Ay: ${currentMonth}`);
        
    } catch (error) {
        console.error('‚ùå Aylƒ±k puanlar sƒ±fƒ±rlanƒ±rken hata:', error);
        alert('‚ùå Aylƒ±k puanlar sƒ±fƒ±rlanƒ±rken bir hata olu≈ütu: ' + error.message);
    } finally {
        // Button'u eski haline getir
        const resetBtn = document.getElementById('reset-monthly-scores-btn');
        resetBtn.textContent = 'üîÑ Aylƒ±k Puanlarƒ± Sƒ±fƒ±rla';
        resetBtn.disabled = false;
    }
}

// Veritabanƒ±nda hafta/ay bilgisini g√ºncelle
async function updatePeriodInDatabase(type, value) {
    try {
        console.log(`üìÖ ${type} bilgisi g√ºncelleniyor:`, value);
        
        // Firestore'da period bilgilerini g√ºncelle
        const periodRef = doc(db, 'system', 'period');
        await updateDoc(periodRef, {
            [type]: value,
            updatedAt: serverTimestamp()
        });
        
        console.log(`‚úÖ ${type} bilgisi ba≈üarƒ±yla g√ºncellendi`);
    } catch (error) {
        console.error(`‚ùå ${type} bilgisi g√ºncellenirken hata:`, error);
        
        // Eƒüer document yoksa olu≈ütur
        try {
            const periodRef = doc(db, 'system', 'period');
            await setDoc(periodRef, {
                week: currentWeek,
                month: currentMonth,
                [type]: value,
                createdAt: serverTimestamp(),
                updatedAt: serverTimestamp()
            });
            console.log(`‚úÖ ${type} bilgisi yeni document olarak olu≈üturuldu`);
        } catch (createError) {
            console.error(`‚ùå ${type} bilgisi olu≈üturulurken hata:`, createError);
        }
    }
}

// Setup form event handlers
function setupFormHandlers() {
    addRouteForm.addEventListener('submit', handleAddRoute);
    console.log('üìù Form event handler kuruldu');
}

// Handle add route form submission
async function handleAddRoute(event) {
    event.preventDefault();
    console.log('üèîÔ∏è Rota ekleme i≈ülemi ba≈ülatƒ±ldƒ±');
    
    // Show loading state
    submitBtn.disabled = true;
    submitBtn.textContent = '‚è≥ Ekleniyor...';
    hideMessages();
    
    try {
        // Get form data
        const formData = new FormData(addRouteForm);
        const rawImageUrl = formData.get('imageUrl');
        const imageUrl = normalizeImageUrl(rawImageUrl);
        const routeData = {
            grade: formData.get('grade'),
            color: formData.get('color'),
            sector: formData.get('sector'),
            imageUrl: imageUrl || null,
            boulderOfWeek: formData.get('boulderOfWeek') === 'on',
            week: currentWeek,
            month: currentMonth,
            createdAt: serverTimestamp()
        };
        
        console.log('üìä Rota verisi:', routeData);
        
        // Validate form data
        if (!routeData.grade || !routeData.color || !routeData.sector) {
            throw new Error('L√ºtfen t√ºm alanlarƒ± doldurun');
        }
        
        // Add route to Firestore
        const docRef = await addDoc(collection(db, 'routes'), routeData);
        console.log('‚úÖ Rota ba≈üarƒ±yla eklendi:', docRef.id);
        
        // Show success message
        showSuccessMessage();
        
        // Reset form
        addRouteForm.reset();
        
    } catch (error) {
        console.error('‚ùå Rota ekleme hatasƒ±:', error);
        showErrorMessage(error.message || 'Bilinmeyen bir hata olu≈ütu');
    } finally {
        // Reset button state
        submitBtn.disabled = false;
        submitBtn.textContent = 'üèîÔ∏è Rota Ekle';
    }
}

// Show success message
function showSuccessMessage() {
    successMessage.style.display = 'block';
    errorMessage.style.display = 'none';
    console.log('‚úÖ Ba≈üarƒ± mesajƒ± g√∂sterildi');
}

// Show error message
function showErrorMessage(message) {
    errorMessage.textContent = `‚ùå ${message}`;
    errorMessage.style.display = 'block';
    successMessage.style.display = 'none';
    console.log('‚ùå Hata mesajƒ± g√∂sterildi:', message);
}

// Hide all messages
function hideMessages() {
    successMessage.style.display = 'none';
    errorMessage.style.display = 'none';
}

// Handle form validation
function validateForm() {
    const grade = document.getElementById('grade').value;
    const color = document.getElementById('color').value.trim();
    const sector = document.getElementById('sector').value;
    
    if (!grade || !color || !sector) {
        showErrorMessage('L√ºtfen t√ºm alanlarƒ± doldurun');
        return false;
    }
    
    if (color.length < 2) {
        showErrorMessage('Renk adƒ± en az 2 karakter olmalƒ±dƒ±r');
        return false;
    }
    
    return true;
}

// Add real-time form validation
document.addEventListener('DOMContentLoaded', function() {
    const inputs = document.querySelectorAll('input, select');
    inputs.forEach(input => {
        input.addEventListener('blur', validateForm);
        input.addEventListener('input', hideMessages);
    });
});

// Setup real-time listeners for routes
function setupRealtimeListeners() {
    console.log('üîÑ Rota dinleyicileri kuruluyor...');
    
    const routesQuery = query(collection(db, 'routes'), orderBy('createdAt', 'desc'));
    
    onSnapshot(routesQuery, (snapshot) => {
        console.log('üìä Rota verisi g√ºncellendi');
        routes = [];
        snapshot.forEach((doc) => {
            routes.push({
                id: doc.id,
                ...doc.data()
            });
        });
        displayRoutes();
    }, (error) => {
        console.error('‚ùå Rota dinleyici hatasƒ±:', error);
        showErrorMessage('Rotalar y√ºklenirken hata olu≈ütu');
    });
}

// Display routes in the list
function displayRoutes() {
    console.log('üìã Rotalar g√∂steriliyor:', routes.length);
    
    if (routes.length === 0) {
        document.getElementById('current-week-routes').innerHTML = '<div class="no-routes">Bu haftanƒ±n rotasƒ± yok</div>';
        document.getElementById('other-routes').innerHTML = '<div class="no-routes">Hen√ºz rota eklenmemi≈ü</div>';
        return;
    }
    
    // Bu haftanƒ±n rotalarƒ±
    const currentWeekRoutes = routes.filter(route => route.week === currentWeek);
    const otherRoutes = routes.filter(route => route.week !== currentWeek);
    
    // Bu haftanƒ±n rotalarƒ±nƒ± g√∂ster
    displayRouteSection('current-week-routes', currentWeekRoutes, 'Bu haftanƒ±n rotasƒ± yok');
    
    // Diƒüer rotalarƒ± g√∂ster
    displayRouteSection('other-routes', otherRoutes, 'Hen√ºz rota eklenmemi≈ü');
}

// Rota b√∂l√ºm√ºn√º g√∂ster
function displayRouteSection(containerId, routes, emptyMessage) {
    const container = document.getElementById(containerId);
    
    if (routes.length === 0) {
        container.innerHTML = `<div class="no-routes">${emptyMessage}</div>`;
        return;
    }
    
    container.innerHTML = routes.map(route => {
        let createdAt = 'Bilinmiyor';
        
        if (route.createdAt) {
            console.log('üìÖ Rota createdAt:', route.createdAt, 'Type:', typeof route.createdAt);
            
            // Firestore Timestamp objesi kontrol√º
            if (route.createdAt.seconds) {
                // Firestore Timestamp objesi
                createdAt = new Date(route.createdAt.seconds * 1000).toLocaleDateString('tr-TR');
                console.log('‚úÖ Firestore Timestamp (seconds):', createdAt);
            } else if (typeof route.createdAt === 'string') {
                // String timestamp
                createdAt = new Date(route.createdAt).toLocaleDateString('tr-TR');
                console.log('‚úÖ String timestamp:', createdAt);
            } else if (route.createdAt.toDate) {
                // Firestore Timestamp objesi (toDate metodu ile)
                createdAt = route.createdAt.toDate().toLocaleDateString('tr-TR');
                console.log('‚úÖ Firestore Timestamp (toDate):', createdAt);
            } else {
                console.log('‚ùå Bilinmeyen timestamp formatƒ±:', route.createdAt);
            }
        }
            
        const boulderOfWeekBadge = route.boulderOfWeek ? 
            '<div class="boulder-of-week-badge">‚≠ê Boulder of the Week</div>' : '';
        
        const imageSection = route.imageUrl ? 
            `<div class="route-image">
                <img src="${route.imageUrl}" alt="Rota resmi" onerror="this.style.display='none'">
            </div>` : '';
            
        return `
            <div class="route-item ${route.boulderOfWeek ? 'boulder-of-week' : ''}" data-route-id="${route.id}">
                ${boulderOfWeekBadge}
                <div class="route-header">
                    <div class="route-grade">Seviye ${route.grade}</div>
                    <button class="delete-btn" onclick="showDeleteConfirmation('${route.id}', '${route.color}', '${route.sector}')">
                        üóëÔ∏è Sil
                    </button>
                </div>
                <div class="route-details">
                    <div class="route-detail">
                        <span class="route-detail-icon">üé®</span>
                        <span>${route.color}</span>
                    </div>
                    <div class="route-detail">
                        <span class="route-detail-icon">üìç</span>
                        <span>${route.sector}</span>
                    </div>
                </div>
                <div class="route-date">
                    üìÖ Eklenme: ${createdAt}
                </div>
                <div class="route-week">
                    üìÖ Hafta: ${route.week || 'Bilinmiyor'}
                </div>
                ${imageSection}
            </div>
        `;
    }).join('');
}

// Setup delete confirmation handlers
function setupDeleteHandlers() {
    confirmDeleteBtn.addEventListener('click', handleConfirmDelete);
    cancelDeleteBtn.addEventListener('click', hideDeleteConfirmation);
    confirmationOverlay.addEventListener('click', (e) => {
        if (e.target === confirmationOverlay) {
            hideDeleteConfirmation();
        }
    });
}

// Show delete confirmation dialog
function showDeleteConfirmation(routeId, color, sector) {
    routeToDelete = routeId;
    confirmationMessage.innerHTML = `
        <strong>${color}</strong> rengindeki <strong>${sector}</strong> sekt√∂r√ºndeki rotayƒ± silmek istediƒüinizden emin misiniz?<br>
        Bu i≈ülem geri alƒ±namaz.
    `;
    confirmationOverlay.style.display = 'flex';
    console.log('‚ö†Ô∏è Silme onayƒ± g√∂steriliyor:', routeId);
}

// Hide delete confirmation dialog
function hideDeleteConfirmation() {
    confirmationOverlay.style.display = 'none';
    routeToDelete = null;
    console.log('‚ùå Silme onayƒ± iptal edildi');
}

// Handle confirm delete
async function handleConfirmDelete() {
    if (!routeToDelete) return;
    
    console.log('üóëÔ∏è Rota siliniyor:', routeToDelete);
    
    try {
        await deleteDoc(doc(db, 'routes', routeToDelete));
        console.log('‚úÖ Rota ba≈üarƒ±yla silindi');
        showSuccessMessage('Rota ba≈üarƒ±yla silindi!');
        hideDeleteConfirmation();
    } catch (error) {
        console.error('‚ùå Rota silme hatasƒ±:', error);
        showErrorMessage('Rota silinirken hata olu≈ütu');
    }
}

// Make showDeleteConfirmation globally available
window.showDeleteConfirmation = showDeleteConfirmation;

console.log('üöÄ Routesetter JavaScript y√ºklendi');
